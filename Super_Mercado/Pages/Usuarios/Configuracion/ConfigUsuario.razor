@page "/Usuario/Configuracion"
@inherits ConfigUsuarioComponentBase


<MudItem xs="12">
	<MudText Typo="Typo.h5" GutterBottom="true">Direccion de: @_username </MudText>
	<EditForm Model="mDireccionUsuario" OnValidSubmit="SaveUsuarioDireccion">
		<MudGrid>
			<MudItem xs=12 sm=12 lg=6 xl=6>
				<MudContainer>

					<MudItem>
						<MudTextField T="string" Label="Direccion" @bind-Value=mDireccionUsuario.Direccion />
					</MudItem>
					<MudItem>
						<MudInputLabel> Comentarios</MudInputLabel>
						<RadzenTextArea @bind-Value=mDireccionUsuario.Comentario Style="width:100%; height:100%;">
						</RadzenTextArea>
					</MudItem>

				</MudContainer>

			</MudItem>
			<MudItem xs=12 sm=12 lg=6 xl=6>


				<MudItem xs="12" Style=" height:400px;">

					<RadzenGoogleMap Zoom="zoomMap" MapClick="MapClick" Center="@(new GoogleMapPosition() {Lat=Convert.ToDouble( mDireccionUsuario.Latitud),Lng= Convert.ToDouble( mDireccionUsuario.Longitud)})">

						<Markers>
							<RadzenGoogleMapMarker Title="Reporte Actual" Label="Direccion Actual" Position="@(new GoogleMapPosition() {Lat=Convert.ToDouble( mDireccionUsuario.Latitud), Lng=Convert.ToDouble( mDireccionUsuario.Longitud)})" />
						</Markers>

					</RadzenGoogleMap>
				</MudItem>

			</MudItem>


			<MudItem xs="12" Class="d-flex justify-center">
				<MudButton Variant="Variant.Filled" DisableElevation="true" Color="Color.Primary" ButtonType=MudBlazor.ButtonType.Submit Size="Size.Large" Class="mt-8">Agregar Direccion</MudButton>
			</MudItem>


		</MudGrid>
	</EditForm>

</MudItem>



	@if (direcciones == null)
{
	<MudItem>
		<MudCard>
			<MudCardHeader>
				<CardHeaderContent>
					<MudText Typo="Typo.h6">UPS</MudText>
				</CardHeaderContent>
				<CardHeaderActions>
				</CardHeaderActions>
			</MudCardHeader>
			<MudCardContent>

				<MudText Typo="Typo.body2">:S No hay direciones</MudText>
			</MudCardContent>
		</MudCard>
	</MudItem>

}
else
{
	@foreach (var i in direcciones)
	{
		<MudItem>
			<MudCard>
				<MudCardHeader>
					<CardHeaderContent>
						<MudText Typo="Typo.h6">@i.Direccion</MudText>
					</CardHeaderContent>
					<CardHeaderActions>
						<MudIconButton Icon="@Icons.Material.Filled.Settings" Color="Color.Default" OnClick="() => LoadEditDireccion(i)" />
					</CardHeaderActions>
				</MudCardHeader>
				<MudCardContent>
					<MudText>Direccion: @i.Comentario</MudText>
				</MudCardContent>
			</MudCard>
		</MudItem>

	}

}

@code {
	int zoomMap = 5;
	bool showMarkedMap = false;



	void MapClick(GoogleMapClickEventArgs args)
	{
		mDireccionUsuario.Latitud = Convert.ToDecimal(args.Position.Lat);
		mDireccionUsuario.Longitud = Convert.ToDecimal(args.Position.Lng);
		zoomMap = 8;
		showMarkedMap = true;


	}


}
